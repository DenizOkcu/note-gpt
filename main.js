"use strict";var t=require("obsidian"),e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},e(t,n)};function n(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}function r(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function c(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,c)}u((r=r.apply(t,e||[])).next())}))}function o(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}}var i,a,c="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},u="object"==typeof document&&document.all,s={all:u,IS_HTMLDDA:void 0===u&&void 0!==u},f=s.all,l=s.IS_HTMLDDA?function(t){return"function"==typeof t||t===f}:function(t){return"function"==typeof t},p={},h=function(t){try{return!!t()}catch(t){return!0}},y=!h((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})),d=function(t){return t&&t.Math===Math&&t},v=d("object"==typeof globalThis&&globalThis)||d("object"==typeof window&&window)||d("object"==typeof self&&self)||d("object"==typeof c&&c)||function(){return this}()||c||Function("return this")(),g=l,b=s.all,w=s.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:g(t)||t===b}:function(t){return"object"==typeof t?null!==t:g(t)},m=w,S=v.document,O=m(S)&&m(S.createElement),E=function(t){return O?S.createElement(t):{}},T=!y&&!h((function(){return 7!==Object.defineProperty(E("div"),"a",{get:function(){return 7}}).a})),A=y&&h((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),C=w,P=String,j=TypeError,R=function(t){if(C(t))return t;throw new j(P(t)+" is not an object")},I=!h((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})),L=I,_=Function.prototype.call,x=L?_.bind(_):function(){return _.apply(_,arguments)},N=v,D=l,U=function(t,e){return arguments.length<2?(n=N[t],D(n)?n:void 0):N[t]&&N[t][e];var n},k=I,M=Function.prototype,F=M.call,G=k&&M.bind.bind(F,F),z=k?G:function(t){return function(){return F.apply(t,arguments)}},B=z({}.isPrototypeOf),K=v,V="undefined"!=typeof navigator&&String(navigator.userAgent)||"",Y=K.process,q=K.Deno,W=Y&&Y.versions||q&&q.version,H=W&&W.v8;H&&(a=(i=H.split("."))[0]>0&&i[0]<4?1:+(i[0]+i[1])),!a&&V&&(!(i=V.match(/Edge\/(\d+)/))||i[1]>=74)&&(i=V.match(/Chrome\/(\d+)/))&&(a=+i[1]);var J=a,$=h,X=v.String,Q=!!Object.getOwnPropertySymbols&&!$((function(){var t=Symbol("symbol detection");return!X(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&J&&J<41})),Z=Q&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,tt=U,et=l,nt=B,rt=Object,ot=Z?function(t){return"symbol"==typeof t}:function(t){var e=tt("Symbol");return et(e)&&nt(e.prototype,rt(t))},it=String,at=function(t){try{return it(t)}catch(t){return"Object"}},ct=l,ut=at,st=TypeError,ft=function(t){if(ct(t))return t;throw new st(ut(t)+" is not a function")},lt=function(t){return null==t},pt=ft,ht=lt,yt=x,dt=l,vt=w,gt=TypeError,bt={exports:{}},wt=v,mt=Object.defineProperty,St=function(t,e){try{mt(wt,t,{value:e,configurable:!0,writable:!0})}catch(n){wt[t]=e}return e},Ot=St,Et="__core-js_shared__",Tt=v[Et]||Ot(Et,{}),At=Tt;(bt.exports=function(t,e){return At[t]||(At[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.33.2",mode:"global",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.33.2/LICENSE",source:"https://github.com/zloirock/core-js"});var Ct=bt.exports,Pt=lt,jt=TypeError,Rt=function(t){if(Pt(t))throw new jt("Can't call method on "+t);return t},It=Rt,Lt=Object,_t=function(t){return Lt(It(t))},xt=_t,Nt=z({}.hasOwnProperty),Dt=Object.hasOwn||function(t,e){return Nt(xt(t),e)},Ut=z,kt=0,Mt=Math.random(),Ft=Ut(1..toString),Gt=function(t){return"Symbol("+(void 0===t?"":t)+")_"+Ft(++kt+Mt,36)},zt=Ct,Bt=Dt,Kt=Gt,Vt=Q,Yt=Z,qt=v.Symbol,Wt=zt("wks"),Ht=Yt?qt.for||qt:qt&&qt.withoutSetter||Kt,Jt=function(t){return Bt(Wt,t)||(Wt[t]=Vt&&Bt(qt,t)?qt[t]:Ht("Symbol."+t)),Wt[t]},$t=x,Xt=w,Qt=ot,Zt=function(t,e){var n=t[e];return ht(n)?void 0:pt(n)},te=function(t,e){var n,r;if("string"===e&&dt(n=t.toString)&&!vt(r=yt(n,t)))return r;if(dt(n=t.valueOf)&&!vt(r=yt(n,t)))return r;if("string"!==e&&dt(n=t.toString)&&!vt(r=yt(n,t)))return r;throw new gt("Can't convert object to primitive value")},ee=TypeError,ne=Jt("toPrimitive"),re=function(t,e){if(!Xt(t)||Qt(t))return t;var n,r=Zt(t,ne);if(r){if(void 0===e&&(e="default"),n=$t(r,t,e),!Xt(n)||Qt(n))return n;throw new ee("Can't convert object to primitive value")}return void 0===e&&(e="number"),te(t,e)},oe=re,ie=ot,ae=function(t){var e=oe(t,"string");return ie(e)?e:e+""},ce=y,ue=T,se=A,fe=R,le=ae,pe=TypeError,he=Object.defineProperty,ye=Object.getOwnPropertyDescriptor,de="enumerable",ve="configurable",ge="writable";p.f=ce?se?function(t,e,n){if(fe(t),e=le(e),fe(n),"function"==typeof t&&"prototype"===e&&"value"in n&&ge in n&&!n[ge]){var r=ye(t,e);r&&r[ge]&&(t[e]=n.value,n={configurable:ve in n?n[ve]:r[ve],enumerable:de in n?n[de]:r[de],writable:!1})}return he(t,e,n)}:he:function(t,e,n){if(fe(t),e=le(e),fe(n),ue)try{return he(t,e,n)}catch(t){}if("get"in n||"set"in n)throw new pe("Accessors not supported");return"value"in n&&(t[e]=n.value),t};var be={exports:{}},we=y,me=Dt,Se=Function.prototype,Oe=we&&Object.getOwnPropertyDescriptor,Ee=me(Se,"name"),Te={EXISTS:Ee,PROPER:Ee&&"something"===function(){}.name,CONFIGURABLE:Ee&&(!we||we&&Oe(Se,"name").configurable)},Ae=l,Ce=Tt,Pe=z(Function.toString);Ae(Ce.inspectSource)||(Ce.inspectSource=function(t){return Pe(t)});var je,Re,Ie,Le=Ce.inspectSource,_e=l,xe=v.WeakMap,Ne=_e(xe)&&/native code/.test(String(xe)),De=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},Ue=p,ke=De,Me=y?function(t,e,n){return Ue.f(t,e,ke(1,n))}:function(t,e,n){return t[e]=n,t},Fe=Gt,Ge=Ct("keys"),ze=function(t){return Ge[t]||(Ge[t]=Fe(t))},Be={},Ke=Ne,Ve=v,Ye=w,qe=Me,We=Dt,He=Tt,Je=ze,$e=Be,Xe="Object already initialized",Qe=Ve.TypeError,Ze=Ve.WeakMap;if(Ke||He.state){var tn=He.state||(He.state=new Ze);tn.get=tn.get,tn.has=tn.has,tn.set=tn.set,je=function(t,e){if(tn.has(t))throw new Qe(Xe);return e.facade=t,tn.set(t,e),e},Re=function(t){return tn.get(t)||{}},Ie=function(t){return tn.has(t)}}else{var en=Je("state");$e[en]=!0,je=function(t,e){if(We(t,en))throw new Qe(Xe);return e.facade=t,qe(t,en,e),e},Re=function(t){return We(t,en)?t[en]:{}},Ie=function(t){return We(t,en)}}var nn={set:je,get:Re,has:Ie,enforce:function(t){return Ie(t)?Re(t):je(t,{})},getterFor:function(t){return function(e){var n;if(!Ye(e)||(n=Re(e)).type!==t)throw new Qe("Incompatible receiver, "+t+" required");return n}}},rn=z,on=h,an=l,cn=Dt,un=y,sn=Te.CONFIGURABLE,fn=Le,ln=nn.enforce,pn=nn.get,hn=String,yn=Object.defineProperty,dn=rn("".slice),vn=rn("".replace),gn=rn([].join),bn=un&&!on((function(){return 8!==yn((function(){}),"length",{value:8}).length})),wn=String(String).split("String"),mn=be.exports=function(t,e,n){"Symbol("===dn(hn(e),0,7)&&(e="["+vn(hn(e),/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!cn(t,"name")||sn&&t.name!==e)&&(un?yn(t,"name",{value:e,configurable:!0}):t.name=e),bn&&n&&cn(n,"arity")&&t.length!==n.arity&&yn(t,"length",{value:n.arity});try{n&&cn(n,"constructor")&&n.constructor?un&&yn(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var r=ln(t);return cn(r,"source")||(r.source=gn(wn,"string"==typeof e?e:"")),t};Function.prototype.toString=mn((function(){return an(this)&&pn(this).source||fn(this)}),"toString");var Sn=be.exports,On=l,En=p,Tn=Sn,An=St,Cn=function(t,e,n,r){r||(r={});var o=r.enumerable,i=void 0!==r.name?r.name:e;if(On(n)&&Tn(n,i,r),r.global)o?t[e]=n:An(e,n);else{try{r.unsafe?t[e]&&(o=!0):delete t[e]}catch(t){}o?t[e]=n:En.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t},Pn={};Pn[Jt("toStringTag")]="z";var jn="[object z]"===String(Pn),Rn=z,In=Rn({}.toString),Ln=Rn("".slice),_n=function(t){return Ln(In(t),8,-1)},xn=jn,Nn=l,Dn=_n,Un=Jt("toStringTag"),kn=Object,Mn="Arguments"===Dn(function(){return arguments}()),Fn=xn?Dn:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=kn(t),Un))?n:Mn?Dn(e):"Object"===(r=Dn(e))&&Nn(e.callee)?"Arguments":r},Gn=Fn,zn=String,Bn=function(t){if("Symbol"===Gn(t))throw new TypeError("Cannot convert a Symbol value to a string");return zn(t)},Kn=TypeError,Vn=function(t,e){if(t<e)throw new Kn("Not enough arguments");return t},Yn=Cn,qn=z,Wn=Bn,Hn=Vn,Jn=URLSearchParams,$n=Jn.prototype,Xn=qn($n.append),Qn=qn($n.delete),Zn=qn($n.forEach),tr=qn([].push),er=new Jn("a=1&a=2&b=3");er.delete("a",1),er.delete("b",void 0),er+""!="a=2"&&Yn($n,"delete",(function(t){var e=arguments.length,n=e<2?void 0:arguments[1];if(e&&void 0===n)return Qn(this,t);var r=[];Zn(this,(function(t,e){tr(r,{key:e,value:t})})),Hn(e,1);for(var o,i=Wn(t),a=Wn(n),c=0,u=0,s=!1,f=r.length;c<f;)o=r[c++],s||o.key===i?(s=!0,Qn(this,o.key)):u++;for(;u<f;)(o=r[u++]).key===i&&o.value===a||Xn(this,o.key,o.value)}),{enumerable:!0,unsafe:!0});var nr=Cn,rr=z,or=Bn,ir=Vn,ar=URLSearchParams,cr=ar.prototype,ur=rr(cr.getAll),sr=rr(cr.has),fr=new ar("a=1");!fr.has("a",2)&&fr.has("a",void 0)||nr(cr,"has",(function(t){var e=arguments.length,n=e<2?void 0:arguments[1];if(e&&void 0===n)return sr(this,t);var r=ur(this,t);ir(e,1);for(var o=or(n),i=0;i<r.length;)if(r[i++]===o)return!0;return!1}),{enumerable:!0,unsafe:!0});var lr=Sn,pr=p,hr=function(t,e,n){return n.get&&lr(n.get,e,{getter:!0}),n.set&&lr(n.set,e,{setter:!0}),pr.f(t,e,n)},yr=y,dr=z,vr=hr,gr=URLSearchParams.prototype,br=dr(gr.forEach);yr&&!("size"in gr)&&vr(gr,"size",{get:function(){var t=0;return br(this,(function(){t++})),t},configurable:!0,enumerable:!0});var wr={},mr={},Sr={}.propertyIsEnumerable,Or=Object.getOwnPropertyDescriptor,Er=Or&&!Sr.call({1:2},1);mr.f=Er?function(t){var e=Or(this,t);return!!e&&e.enumerable}:Sr;var Tr=h,Ar=_n,Cr=Object,Pr=z("".split),jr=Tr((function(){return!Cr("z").propertyIsEnumerable(0)}))?function(t){return"String"===Ar(t)?Pr(t,""):Cr(t)}:Cr,Rr=Rt,Ir=function(t){return jr(Rr(t))},Lr=y,_r=x,xr=mr,Nr=De,Dr=Ir,Ur=ae,kr=Dt,Mr=T,Fr=Object.getOwnPropertyDescriptor;wr.f=Lr?Fr:function(t,e){if(t=Dr(t),e=Ur(e),Mr)try{return Fr(t,e)}catch(t){}if(kr(t,e))return Nr(!_r(xr.f,t,e),t[e])};var Gr={},zr=Math.ceil,Br=Math.floor,Kr=Math.trunc||function(t){var e=+t;return(e>0?Br:zr)(e)},Vr=function(t){var e=+t;return e!=e||0===e?0:Kr(e)},Yr=Vr,qr=Math.max,Wr=Math.min,Hr=Vr,Jr=Math.min,$r=function(t){return t>0?Jr(Hr(t),9007199254740991):0},Xr=function(t){return $r(t.length)},Qr=Ir,Zr=function(t,e){var n=Yr(t);return n<0?qr(n+e,0):Wr(n,e)},to=Xr,eo=function(t){return function(e,n,r){var o,i=Qr(e),a=to(i),c=Zr(r,a);if(t&&n!=n){for(;a>c;)if((o=i[c++])!=o)return!0}else for(;a>c;c++)if((t||c in i)&&i[c]===n)return t||c||0;return!t&&-1}},no={includes:eo(!0),indexOf:eo(!1)},ro=Dt,oo=Ir,io=no.indexOf,ao=Be,co=z([].push),uo=function(t,e){var n,r=oo(t),o=0,i=[];for(n in r)!ro(ao,n)&&ro(r,n)&&co(i,n);for(;e.length>o;)ro(r,n=e[o++])&&(~io(i,n)||co(i,n));return i},so=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"].concat("length","prototype");Gr.f=Object.getOwnPropertyNames||function(t){return uo(t,so)};var fo={};fo.f=Object.getOwnPropertySymbols;var lo=U,po=Gr,ho=fo,yo=R,vo=z([].concat),go=lo("Reflect","ownKeys")||function(t){var e=po.f(yo(t)),n=ho.f;return n?vo(e,n(t)):e},bo=Dt,wo=go,mo=wr,So=p,Oo=h,Eo=l,To=/#|\.prototype\./,Ao=function(t,e){var n=Po[Co(t)];return n===Ro||n!==jo&&(Eo(e)?Oo(e):!!e)},Co=Ao.normalize=function(t){return String(t).replace(To,".").toLowerCase()},Po=Ao.data={},jo=Ao.NATIVE="N",Ro=Ao.POLYFILL="P",Io=Ao,Lo=v,_o=wr.f,xo=Me,No=Cn,Do=St,Uo=function(t,e,n){for(var r=wo(e),o=So.f,i=mo.f,a=0;a<r.length;a++){var c=r[a];bo(t,c)||n&&bo(n,c)||o(t,c,i(e,c))}},ko=Io,Mo=h,Fo=y,Go=Jt("iterator"),zo=!Mo((function(){var t=new URL("b?a=1&b=2&c=3","http://a"),e=t.searchParams,n=new URLSearchParams("a=1&a=2&b=3"),r="";return t.pathname="c%20d",e.forEach((function(t,n){e.delete("b"),r+=n+t})),n.delete("a",2),n.delete("b",void 0),!e.size&&!Fo||!e.sort||"http://a/c%20d?a=1&c=3"!==t.href||"3"!==e.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!e[Go]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://ÑÐµÑÑ").host||"#%D0%B1"!==new URL("http://a#Ð±").hash||"a1c3"!==r||"x"!==new URL("http://x",void 0).host})),Bo=function(t,e){var n,r,o,i,a,c=t.target,u=t.global,s=t.stat;if(n=u?Lo:s?Lo[c]||Do(c,{}):(Lo[c]||{}).prototype)for(r in e){if(i=e[r],o=t.dontCallGetSet?(a=_o(n,r))&&a.value:n[r],!ko(u?r:c+(s?".":"#")+r,t.forced)&&void 0!==o){if(typeof i==typeof o)continue;Uo(i,o)}(t.sham||o&&o.sham)&&xo(i,"sham",!0),No(n,r,i,t)}},Ko=h,Vo=Vn,Yo=Bn,qo=zo,Wo=U("URL");Bo({target:"URL",stat:!0,forced:!(qo&&Ko((function(){Wo.canParse()})))},{canParse:function(t){var e=Vo(arguments.length,1),n=Yo(t),r=e<2||void 0===arguments[1]?void 0:Yo(arguments[1]);try{return!!new Wo(n,r)}catch(t){return!1}}});var Ho,Jo,$o,Xo=Xr,Qo="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,Zo=!h((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})),ti=Dt,ei=l,ni=_t,ri=Zo,oi=ze("IE_PROTO"),ii=Object,ai=ii.prototype,ci=ri?ii.getPrototypeOf:function(t){var e=ni(t);if(ti(e,oi))return e[oi];var n=e.constructor;return ei(n)&&e instanceof n?n.prototype:e instanceof ii?ai:null},ui=z,si=ft,fi=l,li=String,pi=TypeError,hi=function(t,e,n){try{return ui(si(Object.getOwnPropertyDescriptor(t,e)[n]))}catch(t){}},yi=R,di=function(t){if("object"==typeof t||fi(t))return t;throw new pi("Can't set "+li(t)+" as a prototype")},vi=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=hi(Object.prototype,"__proto__","set"))(n,[]),e=n instanceof Array}catch(t){}return function(n,r){return yi(n),di(r),e?t(n,r):n.__proto__=r,n}}():void 0),gi=Qo,bi=y,wi=v,mi=l,Si=w,Oi=Dt,Ei=Fn,Ti=at,Ai=Me,Ci=Cn,Pi=hr,ji=B,Ri=ci,Ii=vi,Li=Jt,_i=Gt,xi=nn.enforce,Ni=nn.get,Di=wi.Int8Array,Ui=Di&&Di.prototype,ki=wi.Uint8ClampedArray,Mi=ki&&ki.prototype,Fi=Di&&Ri(Di),Gi=Ui&&Ri(Ui),zi=Object.prototype,Bi=wi.TypeError,Ki=Li("toStringTag"),Vi=_i("TYPED_ARRAY_TAG"),Yi="TypedArrayConstructor",qi=gi&&!!Ii&&"Opera"!==Ei(wi.opera),Wi=!1,Hi={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},Ji={BigInt64Array:8,BigUint64Array:8},$i=function(t){var e=Ri(t);if(Si(e)){var n=Ni(e);return n&&Oi(n,Yi)?n[Yi]:$i(e)}},Xi=function(t){if(!Si(t))return!1;var e=Ei(t);return Oi(Hi,e)||Oi(Ji,e)};for(Ho in Hi)($o=(Jo=wi[Ho])&&Jo.prototype)?xi($o)[Yi]=Jo:qi=!1;for(Ho in Ji)($o=(Jo=wi[Ho])&&Jo.prototype)&&(xi($o)[Yi]=Jo);if((!qi||!mi(Fi)||Fi===Function.prototype)&&(Fi=function(){throw new Bi("Incorrect invocation")},qi))for(Ho in Hi)wi[Ho]&&Ii(wi[Ho],Fi);if((!qi||!Gi||Gi===zi)&&(Gi=Fi.prototype,qi))for(Ho in Hi)wi[Ho]&&Ii(wi[Ho].prototype,Gi);if(qi&&Ri(Mi)!==Gi&&Ii(Mi,Gi),bi&&!Oi(Gi,Ki))for(Ho in Wi=!0,Pi(Gi,Ki,{configurable:!0,get:function(){return Si(this)?this[Vi]:void 0}}),Hi)wi[Ho]&&Ai(wi[Ho],Vi,Ho);var Qi={NATIVE_ARRAY_BUFFER_VIEWS:qi,TYPED_ARRAY_TAG:Wi&&Vi,aTypedArray:function(t){if(Xi(t))return t;throw new Bi("Target is not a typed array")},aTypedArrayConstructor:function(t){if(mi(t)&&(!Ii||ji(Fi,t)))return t;throw new Bi(Ti(t)+" is not a typed array constructor")},exportTypedArrayMethod:function(t,e,n,r){if(bi){if(n)for(var o in Hi){var i=wi[o];if(i&&Oi(i.prototype,t))try{delete i.prototype[t]}catch(n){try{i.prototype[t]=e}catch(t){}}}Gi[t]&&!n||Ci(Gi,t,n?e:qi&&Ui[t]||e,r)}},exportTypedArrayStaticMethod:function(t,e,n){var r,o;if(bi){if(Ii){if(n)for(r in Hi)if((o=wi[r])&&Oi(o,t))try{delete o[t]}catch(t){}if(Fi[t]&&!n)return;try{return Ci(Fi,t,n?e:qi&&Fi[t]||e)}catch(t){}}for(r in Hi)!(o=wi[r])||o[t]&&!n||Ci(o,t,e)}},getTypedArrayConstructor:$i,isView:function(t){if(!Si(t))return!1;var e=Ei(t);return"DataView"===e||Oi(Hi,e)||Oi(Ji,e)},isTypedArray:Xi,TypedArray:Fi,TypedArrayPrototype:Gi},Zi=function(t,e){for(var n=Xo(t),r=new e(n),o=0;o<n;o++)r[o]=t[n-o-1];return r},ta=Qi.aTypedArray,ea=Qi.getTypedArrayConstructor;(0,Qi.exportTypedArrayMethod)("toReversed",(function(){return Zi(ta(this),ea(this))}));var na=Xr,ra=ft,oa=function(t,e){for(var n=0,r=na(e),o=new t(r);r>n;)o[n]=e[n++];return o},ia=Qi.aTypedArray,aa=Qi.getTypedArrayConstructor,ca=Qi.exportTypedArrayMethod,ua=z(Qi.TypedArrayPrototype.sort);ca("toSorted",(function(t){void 0!==t&&ra(t);var e=ia(this),n=oa(aa(e),e);return ua(n,t)}));var sa=Xr,fa=Vr,la=RangeError,pa=Fn,ha=re,ya=TypeError,da=function(t,e,n,r){var o=sa(t),i=fa(n),a=i<0?o+i:i;if(a>=o||a<0)throw new la("Incorrect index");for(var c=new e(o),u=0;u<o;u++)c[u]=u===a?r:t[u];return c},va=function(t){var e=pa(t);return"BigInt64Array"===e||"BigUint64Array"===e},ga=Vr,ba=function(t){var e=ha(t,"number");if("number"==typeof e)throw new ya("Can't convert number to bigint");return BigInt(e)},wa=Qi.aTypedArray,ma=Qi.getTypedArrayConstructor,Sa=Qi.exportTypedArrayMethod,Oa=!!function(){try{new Int8Array(1).with(2,{valueOf:function(){throw 8}})}catch(t){return 8===t}}();function Ea(){let t;return function*(e){for(t=void 0===t?e:function(t,e){const n=new Uint8Array(t.length+e.length);return n.set(t),n.set(e,t.length),n}(t,e);t&&t.length;){const e=t.findIndex((t=>[Ta.NewLine,Ta.CarriageReturn].includes(t)));if(!(-1!==e))break;const n=t[e]===Ta.CarriageReturn&&t[e+1]===Ta.NewLine?e+1:e,r=t.findIndex((t=>[Ta.Colon].includes(t))),o=-1!==r&&r<e?r:e;yield[t.subarray(0,e),o],t=t.subarray(n+1)}}}Sa("with",{with:function(t,e){var n=wa(this),r=ga(t),o=va(n)?ba(e):+e;return da(n,ma(n),r,o)}}.with,!Oa);var Ta=function(t){return t[t.NewLine=10]="NewLine",t[t.CarriageReturn=13]="CarriageReturn",t[t.Space=32]="Space",t[t.Colon=58]="Colon",t}(Ta||{});const Aa="text/event-stream";class Ca extends EventTarget{CONNECTING=0;OPEN=1;CLOSED=2;readyState=this.CONNECTING;onerror=null;onmessage=null;onopen=null;onRetryDelayReceived=null;constructor(t,e){super(),this.url=t instanceof URL?t.toString():t,this.options=e??{},this.retry=e?.retry??5e3,this.connect()}get withCredentials(){return this.options.withCredentials??!1}get retryDelay(){return this.retry}async connect(t){try{this.abortController=new AbortController,this.readyState=this.CONNECTING;const e={...this.options,headers:t?{...this.options.headers,Accept:Aa,"Last-Event-ID":t}:{...this.options.headers,Accept:Aa},cache:"no-store",credentials:this.withCredentials?"include":"omit",signal:this.abortController?.signal},n=await globalThis.fetch(this.url,e);if(200!==n.status)return this.failConnection(`Request failed with status code ${n.status}`);if(!n.headers.get("Content-Type")?.includes(Aa))return this.failConnection(`Request failed with wrong content type '${n.headers.get("Content-Type")}'`);if(!n?.body)return this.failConnection("Request failed with empty response body'");this.announceConnection();const r=n.body.getReader(),o=Ea(),i=function(){let t;const e=new TextDecoder;return function*(n,r){if(0===n.length)t&&(yield[t]),t={data:"",event:"",id:"",retry:void 0};else if(r>0){const o=e.decode(n.subarray(0,r)),i=r+(n[r+1]===Ta.Space?2:1),a=e.decode(n.subarray(i));switch(t??={data:"",event:"",id:"",retry:void 0},o){case"data":t.data=t.data?t.data+"\n"+a:a;break;case"event":t.event=a;break;case"id":t.id=a,yield[void 0,a,void 0];break;case"retry":const e=parseInt(a,10);isNaN(e)||(t.retry=e,yield[void 0,void 0,e])}}}}();for await(const t of async function*(t){let e=await t.read();for(;!e.done;)yield e.value,e=await t.read()}(r))for await(const[e,r]of o(t))for await(const[t,o,a]of i(e,r))void 0!==o?this.currentLastEventId=o:void 0!==a?(this.retry=a,this.onRetryDelayReceived?.(a)):t&&this.dispatchMessage(t,this.currentLastEventId,n.url)}catch(t){if("object"==typeof t&&"AbortError"===t?.name)return;return void await this.reconnect("Reconnecting EventSource because of error",t)}await this.reconnect("Reconnecting because EventSource connection closed")}async reconnect(t,e){const n=new Event("error");this.dispatchEvent(n),this.onerror?.(n),e&&console.warn("Error occurred in EventSource",e??""),this.readyState===this.CLOSED||this.options.disableRetry||(t&&console.warn(t,e??""),setTimeout((async()=>{await this.connect(this.currentLastEventId)}),this.retry))}dispatchMessage(t,e,n){const r=n&&URL.canParse(n)?new URL(n):void 0,o=t?.event?t.event:"message",i=new MessageEvent(o,{data:t?.data,lastEventId:t?.id||e,origin:r?.origin});this.dispatchEvent(i),"message"===o&&this.onmessage?.(i)}failConnection(t){console.error("Fatal error occurred in EventSource",t),this.readyState=this.CLOSED;const e=new Event("error");this.dispatchEvent(e),this.onerror?.(e)}announceConnection(){console.debug("Connection established"),this.readyState=this.OPEN;const t=new Event("open");this.dispatchEvent(t),this.onopen?.(t)}close(){this.readyState=this.CLOSED,this.abortController?.abort()}addEventListener(t,e,n){super.addEventListener(t,e,n)}removeEventListener(t,e,n){super.removeEventListener(t,e,n)}}var Pa={apiKey:"default"},ja=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.fileContent="",t}return n(i,e),i.prototype.onload=function(){return r(this,void 0,void 0,(function(){var t=this;return o(this,(function(e){switch(e.label){case 0:return[4,this.loadSettings()];case 1:return e.sent(),this.addCommand({id:"call-gpt-completions",name:"Generate Text with GPT",callback:function(){return r(t,void 0,void 0,(function(){var t;return o(this,(function(e){switch(e.label){case 0:return t=[{role:"system",content:"You are a helpful assistant"},{role:"user",content:"Write me function in Ruby which can add all even numbers until a number which is given as parameter"}],[4,this.callChatGPTStream(t)];case 1:return e.sent(),[2]}}))}))}}),this.addSettingTab(new Ra(this.app,this)),this.registerInterval(window.setInterval((function(){return console.log("setInterval")}),3e5)),[2]}}))}))},i.prototype.onunload=function(){},i.prototype.callChatGPTStream=function(t){return r(this,void 0,void 0,(function(){var e,n,r,i,a=this;return o(this,(function(o){return(e=this.settings.apiKey)?(n={"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},r={model:"gpt-4-turbo-preview",messages:t,stream:!0},(i=new Ca("https://api.openai.com/v1/chat/completions",{method:"POST",headers:n,body:JSON.stringify(r)})).onmessage=function(t){try{a.handleChunk(t.data)}catch(t){i.close()}},i.onerror=function(t){i.close(),console.error("Error occurred:",t)},[2]):(console.log("No OpenAI API Key set"),[2])}))}))},i.prototype.handleChunk=function(t){if("[DONE]"===t){this.appendTextToActiveFile("\n");var e={line:editor.lastLine()+1,ch:0};throw editor.setCursor(e),new Error("Stream ended with [DONE]")}try{var n=JSON.parse(t).choices[0].delta.content;n&&this.appendTextToActiveFile(n)}catch(t){console.error("Error parsing JSON:",t)}},i.prototype.appendTextToActiveFile=function(e){return r(this,void 0,void 0,(function(){var n,r;return o(this,(function(o){switch(o.label){case 0:return[4,this.app.workspace.getActiveFile()];case 1:return(n=o.sent())?""!=this.fileContent?[3,3]:(r=this,[4,this.app.vault.read(n)]):(new t.Notice("No active file"),[2]);case 2:r.fileContent=o.sent(),o.label=3;case 3:return this.fileContent+=e,[4,this.app.vault.modify(n,this.fileContent)];case 4:return o.sent(),[2]}}))}))},i.prototype.loadSettings=function(){return r(this,void 0,void 0,(function(){var t,e,n,r;return o(this,(function(o){switch(o.label){case 0:return t=this,n=(e=Object).assign,r=[{},Pa],[4,this.loadData()];case 1:return t.settings=n.apply(e,r.concat([o.sent()])),[2]}}))}))},i.prototype.saveSettings=function(){return r(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,this.saveData(this.settings)];case 1:return t.sent(),[2]}}))}))},i}(t.Plugin),Ra=function(e){function i(t,n){var r=e.call(this,t,n)||this;return r.plugin=n,r}return n(i,e),i.prototype.display=function(){var e=this,n=this.containerEl;n.empty(),new t.Setting(n).setName("noteGPT Settings").setDesc("OpenAI API Key").addText((function(t){return t.setPlaceholder("Enter your API Key").setValue(e.plugin.settings.apiKey).onChange((function(t){return r(e,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return this.plugin.settings.apiKey=t,[4,this.plugin.saveSettings()];case 1:return e.sent(),[2]}}))}))}))}))},i}(t.PluginSettingTab);module.exports=ja;
//# sourceMappingURL=main.js.map
